<!DOCTYPE html>
<html lang="pl"><head>
  <meta charset="UTF-8">
  <title>Ćwiczenie Hanzi</title>
  <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5.0/dist/hanzi-writer.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
      color: #333;
      transform-origin: top left;
      transition: transform 0.2s ease;
    }

    #appContainer {
      max-width: 1200px;
      margin: 0 auto;
    }

    #inputArea, #controlsArea {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }

    #inputArea summary {
        font-size: 1.1em;
        font-weight: 600;
        cursor: pointer;
        margin-bottom: 15px;
    }

    #hanziInput {
      font-size: 18px;
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .control-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .control-group {
        display: flex;
        flex-direction: column;
    }

    .control-group label {
        margin-bottom: 5px;
        font-size: 14px;
        color: #555;
    }

    .control-group input[type="number"] {
        padding: 8px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 5px;
        width: 100%;
        box-sizing: border-box;
    }

    .button-group button {
      font-size: 16px;
      padding: 10px 18px;
      margin: 5px 5px 5px 0;
      border: none;
      background-color: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .button-group button:hover {
      background-color: #0056b3;
    }
    
    .button-group button.secondary {
        background-color: #6c757d;
    }
    .button-group button.secondary:hover {
        background-color: #5a6268;
    }

    /* Style dla przełącznika */
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 28px;
        margin-top: 5px;
    }
    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 28px;
    }
    .slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: #007bff;
    }
    input:checked + .slider:before {
        transform: translateX(22px);
    }

    #hanziContainer {
      display: flex;
      flex-direction: column;
    }
    
    /* Style dla stałego układu */
    #hanziContainer.fixed-layout {
        overflow-x: auto;
        padding-bottom: 15px;
    }
    #hanziContainer.fixed-layout .hanzi-row {
        flex-wrap: nowrap;
    }


    .hanzi-row {
      display: flex;
      flex-wrap: wrap; /* Domyślnie elastyczny */
    }

    .hanzi-box {
      border: 2px solid #666;
      background-color: white;
      position: relative;
    }

    .grid-lines {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 1;
    }

    .hanzi-svg {
      z-index: 2;
      position: absolute;
      top: 0;
      left: 0;
    }
  </style>
</head>
<body style="transform: scale(1);">

<div id="appContainer">
    <div id="inputArea">
      <details>
        <summary>Wprowadź znaki Hanzi</summary>
        <textarea id="hanziInput" rows="3" placeholder="Wklej tutaj chińskie znaki...">我的女朋友是我的同学</textarea>
      </details>
    </div>

    <div id="controlsArea">
        <div class="control-grid">
            <div class="control-group">
                <label for="zoomInput">Powiększenie (%)</label>
                <input type="number" id="zoomInput" value="100" oninput="updateZoom()">
            </div>
            <div class="control-group">
                <label for="boxSizeInput">Rozmiar kwadratu (px)</label>
                <input type="number" id="boxSizeInput" value="250">
            </div>
            <div class="control-group">
                <label for="gridThicknessInput">Grubość siatki (px)</label>
                <input type="number" id="gridThicknessInput" value="1" min="0">
            </div>
            <div class="control-group">
                <label for="gapInput">Odstęp (px)</label>
                <input type="number" id="gapInput" value="20" min="0">
            </div>
            <div class="control-group">
                <label for="perRowInput">Liczba w rzędzie</label>
                <input type="number" id="perRowInput" value="5" min="1">
            </div>
            <div class="control-group">
                <label>Układ: <span id="layoutLabel">Elastyczny</span></label>
                <label class="toggle-switch">
                    <input type="checkbox" id="layoutToggle" checked="" onchange="applyLayout()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        <div class="button-group">
            <button onclick="generateHanzi()">Generuj quizy</button>
            <button onclick="resetQuiz()" class="secondary">Reset</button>
            <button onclick="solveAll()" class="secondary">Rozwiąż</button>
        </div>
    </div>

    <div id="hanziContainer"></div>
</div>

<script>
let writers = [];

// Funkcja do aktualizacji powiększenia strony
function updateZoom() {
  const zoomValue = document.getElementById('zoomInput').value;
  const scale = Math.max(10, zoomValue) / 100;
  document.body.style.transform = `scale(${scale})`;
}

// Funkcja do zmiany trybu układu (elastyczny/stały)
function applyLayout() {
    const container = document.getElementById('hanziContainer');
    const toggle = document.getElementById('layoutToggle');
    const label = document.getElementById('layoutLabel');
    const isFlexible = toggle.checked;

    if (isFlexible) {
        container.classList.remove('fixed-layout');
        label.textContent = 'Elastyczny';
    } else {
        container.classList.add('fixed-layout');
        label.textContent = 'Stały';
    }
}

// Funkcja do generowania siatki 4x4 wewnątrz kwadratu
function generateGridSVG(size, thickness) {
  const svgNS = 'http://www.w3.org/2000/svg';
  const svg = document.createElementNS(svgNS, 'svg');
  svg.setAttribute('class', 'grid-lines');
  svg.setAttribute('width', size);
  svg.setAttribute('height', size);

  const step = size / 4;
  const strokeWidth = Math.max(0, thickness);

  for (let i = 1; i < 4; i++) {
    const hLine = document.createElementNS(svgNS, 'line');
    hLine.setAttribute('x1', '0');
    hLine.setAttribute('y1', step * i);
    hLine.setAttribute('x2', size);
    hLine.setAttribute('y2', step * i);
    hLine.setAttribute('stroke', 'black');
    hLine.setAttribute('stroke-width', strokeWidth);
    svg.appendChild(hLine);

    const vLine = document.createElementNS(svgNS, 'line');
    vLine.setAttribute('x1', step * i);
    vLine.setAttribute('y1', '0');
    vLine.setAttribute('x2', step * i);
    vLine.setAttribute('y2', size);
    vLine.setAttribute('stroke', 'black');
    vLine.setAttribute('stroke-width', strokeWidth);
    svg.appendChild(vLine);
  }

  return svg;
}


// Główna funkcja generująca quizy
function generateHanzi() {
  let boxSize = parseInt(document.getElementById('boxSizeInput').value, 10) || 250;
  let gapSize = parseInt(document.getElementById('gapInput').value, 10);
  if (isNaN(gapSize)) gapSize = 20;
  let itemsPerRow = parseInt(document.getElementById('perRowInput').value, 10) || 5;
  let gridThickness = parseInt(document.getElementById('gridThicknessInput').value, 10);
  if (isNaN(gridThickness)) gridThickness = 1;

  const container = document.getElementById('hanziContainer');
  container.innerHTML = '';
  writers = [];
  const input = document.getElementById('hanziInput').value;
  
  // Zastosuj wybrany tryb układu
  applyLayout();
  
  let rowDiv = null;
  let countInRow = 0;
  let charIndex = 0;

  for (let i = 0; i < input.length; i++) {
    const char = input[i];
    if (char.trim() === '') continue;

    if (countInRow % itemsPerRow === 0) {
      rowDiv = document.createElement('div');
      rowDiv.className = 'hanzi-row';
      rowDiv.style.gap = `${gapSize}px`;
      rowDiv.style.marginBottom = `${gapSize}px`;
      container.appendChild(rowDiv);
      countInRow = 0;
    }

    const box = document.createElement('div');
    box.className = 'hanzi-box';
    box.id = 'hanzi-' + charIndex;
    box.style.width = `${boxSize}px`;
    box.style.height = `${boxSize}px`;

    const gridSVG = generateGridSVG(boxSize, gridThickness);
    box.appendChild(gridSVG);

    rowDiv.appendChild(box);

    const writer = HanziWriter.create(box.id, char, {
      width: boxSize,
      height: boxSize,
      showCharacter: false,
      showOutline: false,
      showHintAfterMisses: 1,
      highlightOnComplete: false,
      padding: 5
    });

    writers.push(writer);
    writer.quiz();

    countInRow++;
    charIndex++;
  }
}

function resetQuiz() {
  for (let writer of writers) {
    writer.quiz();
  }
}

function solveAll() {
  for (let writer of writers) {
    writer.showCharacter();
  }
}

// Inicjalizacja przy starcie
updateZoom();
applyLayout();
</script>



</body></html>